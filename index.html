<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Clue: The Floors of Mystery</title>

<style>
body {
  text-align: center;
  font-family: sans-serif;
  position: relative;
}

#hud p { margin: 2px; }

#gameContainer {
  display: flex;
  justify-content: center;
}

canvas {
  background: #b4b4b4;
  border: 1px solid black;
  margin: 5px;
}

/* MOBILE BUTTONS */
#mobileControls {
  position: fixed;
  bottom: 15px;
  left: 50%;
  transform: translateX(-50%);
  display: none;
}

#mobileControls button {
  font-size: 24px;
  padding: 15px 20px;
  margin: 5px;
}

/* show buttons on touch devices */
@media (pointer: coarse) {
  #mobileControls {
    display: block;
  }
}
</style>
</head>

<body>
<h2>Clue: The Floors of Mystery</h2>

<div id="hud">
  <p id="roomInfo"></p>
  <p id="floorInfo"></p>
  <p id="scoreInfo"></p>
  <p id="weaponsInfo"></p>
</div>

<div id="gameContainer">
  <canvas id="gameCanvas" width="800" height="600"></canvas>
</div>

<!-- BUTTON CONTROLS -->
<div id="mobileControls">
  <button onclick="movePlayer('up')">⬆️</button><br>
  <button onclick="movePlayer('left')">⬅️</button>
  <button onclick="movePlayer('down')">⬇️</button>
  <button onclick="movePlayer('right')">➡️</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const roomInfo = document.getElementById("roomInfo");
const floorInfo = document.getElementById("floorInfo");
const scoreInfo = document.getElementById("scoreInfo");
const weaponsInfo = document.getElementById("weaponsInfo");

const player = { x:50, y:50, w:25, h:25, speed:5 };
let score = 0;
let collected = [];
let currentRoom = "BALLROOM";

const ROOMS = {
  "KITCHEN": {
    floor:1,
    weapons:[{x:50,y:50,w:20,h:20}],
    walls:[
      {x:0,y:0,w:800,h:10},{x:0,y:0,w:10,h:600},
      {x:790,y:0,w:10,h:600},{x:0,y:590,w:800,h:10}
    ],
    doors:[{x:780,y:250,w:20,h:100,to:"BALLROOM"}]
  },

  "BALLROOM": {
    floor:1,
    weapons:[{x:300,y:100,w:20,h:20}],
    walls:[
      {x:0,y:0,w:800,h:10},{x:0,y:0,w:10,h:600},
      {x:790,y:0,w:10,h:600},{x:0,y:590,w:800,h:10}
    ],
    doors:[
      {x:0,y:250,w:20,h:100,to:"KITCHEN"}
    ]
  }
};

/* ---------- MOVEMENT ---------- */
function movePlayer(dir) {
  const px = player.x;
  const py = player.y;

  if (dir === "left") player.x -= player.speed;
  if (dir === "right") player.x += player.speed;
  if (dir === "up") player.y -= player.speed;
  if (dir === "down") player.y += player.speed;

  handleCollisions(px, py);
  updateHUD();
}

/* ---------- KEYBOARD ---------- */
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") movePlayer("left");
  if (e.key === "ArrowRight") movePlayer("right");
  if (e.key === "ArrowUp") movePlayer("up");
  if (e.key === "ArrowDown") movePlayer("down");
});

/* ---------- COLLISIONS ---------- */
function handleCollisions(px, py) {
  const room = ROOMS[currentRoom];

  player.x = Math.max(10, Math.min(player.x, 790-player.w));
  player.y = Math.max(10, Math.min(player.y, 590-player.h));

  for (const w of room.walls) {
    if (player.x+player.w>w.x && player.x<w.x+w.w &&
        player.y+player.h>w.y && player.y<w.y+w.h) {
      player.x = px;
      player.y = py;
    }
  }

  for (let i = room.weapons.length - 1; i >= 0; i--) {
    const w = room.weapons[i];
    if (player.x<w.x+w.w && player.x+player.w>w.x &&
        player.y<w.y+w.h && player.y+player.h>w.y) {
      collected.push("Weapon");
      room.weapons.splice(i,1);
      score += 100;
    }
  }

  for (const d of room.doors) {
    if (player.x<d.x+d.w && player.x+player.w>d.x &&
        player.y<d.y+d.h && player.y+player.h>d.y) {
      currentRoom = d.to;
      player.x = 50;
      player.y = 50;
    }
  }
}

/* ---------- HUD ---------- */
function updateHUD() {
  roomInfo.textContent = "Room: " + currentRoom;
  floorInfo.textContent = "Floor: " + ROOMS[currentRoom].floor;
  scoreInfo.textContent = "Score: " + score;
  weaponsInfo.textContent = "Weapons: " + collected.length;
}

/* ---------- DRAW ---------- */
function draw() {
  ctx.clearRect(0,0,800,600);
  const room = ROOMS[currentRoom];

  ctx.fillStyle = "#FFC8C8";
  ctx.fillRect(0,0,800,600);

  ctx.fillStyle = "black";
  room.walls.forEach(w => ctx.fillRect(w.x,w.y,w.w,w.h));

  ctx.fillStyle = "gold";
  room.doors.forEach(d => ctx.fillRect(d.x,d.y,d.w,d.h));

  ctx.fillStyle = "darkred";
  room.weapons.forEach(w => ctx.fillRect(w.x,w.y,w.w,w.h));

  ctx.fillStyle = "blue";
  ctx.fillRect(player.x,player.y,player.w,player.h);
}

/* ---------- LOOP ---------- */
function loop() {
  draw();
  requestAnimationFrame(loop);
}

updateHUD();
loop();
</script>
</body>
</html>
